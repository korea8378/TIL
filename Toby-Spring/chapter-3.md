# toby-spring

## 03월 14일

### keyword

#### 1.템플릿
- 개방 폐쇄 원칙
  - 확장에는 자유롭게 열려 있고 변경에는 굳게 닫혀 있다.
  - 코드에서 어떤 부분은 변경을 통해 그기능이 다양해지고 확장하려는 성질이 있고, 어떤 부분은 고정되어 있고 변하지 않으려는 성질이 있음을 말해준다.
- 템플릿
  - 바뀌는 성질이 다른 코드 중에서 변경이 거의 일어나지 않으며 일정한 패턴으로 유지되는 특성을 가진 부분을 자유롭게 변경되는 성질을 가진 부분으로부터 독립시켜서 효과적으로 활용할 수 있도록 하는 방법이다.

#### 2.초난감 DAO의 예외처리
- Connection과 Statement 객체를 Open, Close
- 로직 실행중 예외가 발생하여 Close를 하지 못하는 경우??
- 커넥션 풀
- try/catch/finally 사용

#### 3.JDBC try/catch/finally 코드의 문제점
- 복잡한 try/catch/finally문
- JDBC 사용 메서드마다의 반복
- 중첩 괄호가 많아 구조가 복잡하여 알아보기 힘들다

#### 4.분리와 재사용을 위한 디자인 패턴 적용
- 메서드 추출
  - 바뀌지 않고 재사용이 가능한 부분을 뽑아 낸다(리팩토링)
- 템플릿 메서드 패턴
  - 변하지 않는 부분은 슈퍼클래스에 두고 변하는 부분은 추상 메소드로 정의해둬서 서브클래스에서 오버라이드하여 새롭게 정의해서 사용
- 전략 패턴
  - 확장에 해당하는 변하는 부분을 별도의 클래스로 만들어 추상화된 인터페이스를 통해 위임하는 방식
- 마이크로 DI

#### 5.JDBC 전략 패턴의 최적화
- USER라는 객체가 필요한 ADD 메서드
- 전략과 클라이언트의 동거
  - 전략패턴을 이용하여 구현한 코드의 문제점
    - DAO 메서드마다 새로운 strategy 인터페이스를 구현한 클래스 작성(클래스 파일이 늘어난다)
    - ADD 메서드와 같이 부가적으로 필요한 정보가 있는 경우 추가적으로 작성 해야한다.
- 로컬 클래스
  - 자신이 사용할 로컬 지역에 클래스를 정의하여 사용
  - 클래스가 내부 클래스이기 때문에 자신이 선언된 곳의 정보에 접근 할 수 있다.
  - 내부 클래스가 선언된 곳의 정보에 접근이 가능하다(but final을 명시해줘야한다.)
- 익명 내부 클래스
  - 이름을 갖지 않는 클래스이다.
  - 상속할 클래스나 구현할 인터페이스를 생성자 대신 사용해서 인스턴스화 한다.

#### 6.컨텍스트와 DI
- 다른 DAO에서 사용가능하게 JDBC 생성/종료 과정을 분리하자
- JdbcContext 생성
- 인터페이스를 통한 의존관계 주입
  - 인터페이스를 사이에 둬서 클래스레벨에서는 의존관계가 고정되지 않게 하고, 런타임 시에 의존할 오브젝트와의 관계를 다이내믹하게 주입해주는 것이 맞다.
  - 따라서 인터페이스를 사용하지 않았다면 엄밀히 말해서 온전한 DI라고 볼 수는 없다. 그러나 스프링의 DI는 넓게 보자면 객체의 생성과 관계설정에 대한 제어권한을 오브젝트에서 제거하고 외부로 위임했다는 IoC개념을 포괄한다.
- 인터페이스를 사용하지 않고 DI하는 두가지 방법
  - 1.인터페이스를 사용하지 않고 DI : 오브젝트 사이의 실제 의존관계가 설정파일에 명확하게 드러난다는 장점, DI의 근본적인 원칙에 부합하지 않는 구체적인 클래스와의 관계가 설정에 직접 노출된다는 단점
  - 2.코드를 이용해 수동으로 DI : 관계를 외부에는 드러내지 않는다는 장점, 여러 오브젝트가 사용하더라도 싱글톤으로 만들 수 없고, DI 작업을 위한 부가적인 코드가 필요하다는 단점
  - 두가지 방법의 장단점을 이해하기 어려우면 인터페이스를 이용하여 DI를 하여라.

#### 7.템플릿과 콜백
- 템플릿/콜백 패턴
- 템플릿
- 콜백
- 단일 메서드 인터페이스를 사용
- 특징
  - 매번 메서드 단위로 사용할 오브젝트를 새롭게 전달받는다
  - 콜백 오브젝트가 내부 클래스로서 자신을 생성한 클라이언트 메서드 내의 정보를 직접 참조
- 재활용이 가능한 코드(템플릿)
- 익명 내부 클래스의 불편함이 발생

#### 8.템플릿 콜백 패턴
- 콜백의 분리와 재활용
- 콜백과 템플릿의 결합

#### 9.스프링만 지원하는 패턴이 아니다
- 템플릿/콜백 패턴
- 전략패턴
- DI
- 다양한 패턴들을 편하게 쓸 수 있도록 해주는 스프링
- 패턴을 이해하고 쓰자.

#### 10.리팩토링 과정
- 고정된 작업 흐름을 갖고 잇으면서 여기저기서 자주 반복되는 코드를 발견
- 중복되는 코드를 분리할 방법을 생각해보는 습관을 키우자
- 중복된 코드를 먼저 메서드로 분리하는 간단한 시도
- 그중 일부 작업을 필요에 따라 바꾸어 사용해야한다면 인터페이스를 사용하여 분리
- 전략 패턴을 적용 하고 DI 사용
- 바뀌는 부분이 한 어플리케이션 안에서 동시에 여러 종류가 만들어 수 있다면 템플릿/콜백 패턴을 사용

#### 11.계산기 콜백 패턴
- 제네릭스
- 곱하기, 더하기, 문자열 추가를 템플릿/콜백 패턴으로 구현

#### 12.JDBCTEMPLATE
- 스프링에서 제공하는 템플릿
- 스프링에서는 JDBCTEMPLATE 말고도 다양한 템플릿을 제공하고있다.

