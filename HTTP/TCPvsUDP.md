# Learning HTTP/2

## 7월 22일

### TCP인가 UDP인가

#### TCP
- 연결, 신뢰성, 혼잡 제어에 대한 합의된 개념을 제공하는 IP 데이터그램 기반의 프로토콜이다.
- 위 개념들은 TCP가 복잡한 인터넷에서 신뢰성 있으면서 지속적으로 동작하는 요소들이다.

#### UDP
- TCP 보다 훨씬 더 원초적이다.
- UDP프로토콜에서, 한 데이터 그램은 다른 UDP 패킷과 아무런 관계가 없다. 연결이라는 것도 없고, 전송을 보장하지도 않으며, 네트워크 상황에 적응하는 능력도 없다.
- UDP 기반 애플리케이션이 차세대 웹의 기반이 될 수 있으려면, 연결이라는 개념을 구현하고, 신뢰성을 높이고, 일종의 혼잡 제어도 있어야 한다.
- 다시 말해서, TCP가 이미 제공하는 많은 것을 다시 구현해야 한다.

#### TCP에서 UDP로 전환해야 할 이유는 무엇인가?
- 그 대답은 TCP가 어디에 구현되었는지와 관계있다. 현대의 OS 대부분의 TCP 스택이 커널에 포함되어 있다.
- TCP 스택은 성능상의 이유로 오래전부터 커널에 포함되어 왔다. 하지만 커널은 변경하기 어렵다.
- 커널 변경은 OS 개발사만 가능하고, OS를 업데이트해야 그 변경이 적용된다.
- TCP를 수정할 수 있다고 하더라도 그렇게 하는 것은 극히 비현실적이라는 것을 알 수 있다.
- TCP에서 UDP 기반으로 사용자 공간에서 근본적으로 다시 구현하려는 하는 이유는 제어권 때문이다.
- TCP 스택을 사용자 공간으로 옮기면 개발자는 네트워크 스택에 대한 전례 없는 제어권을 얻어, 사람들이 브라우저를 자동 업데이트하기만 하면 새 버전을 신속하게 개발하고 배포하는 일을 반복할 수 있게 된다.
- 이것이 바로 TCP와 UDP 논쟁의 핵심이다.

#### QUIC
- HTTP/2의 약점은 인기 있는 TCP 구현에 의존적이라는 것이다.
- TCP 연결은 TCP 느린 시작, 혼잡 회피, 손실된 패킷에 대한 비정상 반응이라는 함정에 빠질수 있다.
- 한 페이지 내의 모든 개체에 대한 모든 요청을 단일 연결 위에서 전송하면, 다중화의 이점을 얻을 수 있지만 TCP 수준에서 발생할 수 있는 HOL 블록킹에 취약해진다.
- 단일 TCP 연결은 여전히 장점이 많지만, 그많은 장점도 모두 개선의 대상이 될 수 있다.
- QUIC는 사용자 공간에 상주하는 UDP 기반의 전송 프로토콜 위에 HTTP/2를 두며, 프로토콜로서의 완전한 면모를 갖추기 위해 암호화와 인증 등의 기능을 포함한다.
- QUIC는 HTTP/2에 상응하는 다중화의 흐름 제어, TLS에 상응하는 보안성, TCP에 상응하는 연결의 의미, 신뢰성, 혼잡 제어를 제공한다.
