# HTTP 완벽 가이드

## 4월 22일

### 12장 기본 인증

#### 개요
- 수백만 명의 사람들이 웹을 통해 개인적인 업무를 보거나 개인적인 데이터에 접근한다.
- 웹은 이런 일을 쉽게 할 수 있게 해주지만, 편리함만으로는 충분하지 않다.
- 모든 정보나 업무가 공용은 아니기 때문에, 허가된 사람만이 데이터에 접근하고 업무를 처리할 수 있어야 한다.
- 서버가 사용자가 누구인지 식별할 수 있어야 한다.
- 서버가 사용자가 누구인지 알면, 그 사용자가 어떤 작업이나 리소스에 접근할 수 있는지 결정할 수 있다.
- 인증은 당신이 누구인지 증명하는 것이다. 보통 사용자 이름과 비밀번호를 입력해서 인증한다.
- HTTP는 자체적인 인증 관련 기능을 제공한다.

#### 인증
- 인증은 당신이 누구인지 증명하는 것이다.
- 완벽한 인증이란 없다. 비밀번호를 누군가가 추측하거나 엿들을 수 있고, 신분증은 도둑맞거나 위조될 수 있다.
- 하지만 당신에 대한 여러 데이터는 당신이 누구인지 판단하는데 도움이 된다.

#### 인증 - HTTP의 인증요구/응답 프레임워크
- HTTP는 사용자 인증을 하는 데 사용하는 자체 인증요구/응답 프레임워크를 제공한다.
- 사용자가 다시 요청을 보낼 때는 인증 정보를 첨부해야한다.
- 만약 인증 정보가 맞지 않으면 서버는 클라이언트에 다시 인증요구를 보내거나 에러를 낼 수 있다.
- 인증 정보가 맞으면 요청은 문제없이 처리가 완료 된다.

#### 인증 - 인증 프로토콜과 헤더
- HTTP는 필요에 따라 고쳐 쓸 수 있는 제어 헤더를 통해, 다른 인증 프로토콜에 맞추어 확장할 수 있는 프레임워크를 제공한다.
- HTTP에는 기본 인증과 다이제스트 인증이라는 두 가지 공식적인 인증 프로토콜이 있다.
- 인증 과정
    - 요청 -> 인증 요구 -> 인증 -> 성공(p.323 표 참고)

#### 인증 - 보안 영역
- HTTP가 어떻게 각 리소스마다 다른 접근 조건을 다루는지 설명할 필요가 있다.
- 웹 서버는 기밀문서를 보안 영역(realm) 그룹으로 나눈다. 보안 영역은 저마다 다른 사용자 권한을 요구한다.
- 아래는 realm 파라미터가 함께 기술된 기본 인증 예다.
<pre><code>
HTTP/1.0 401 Unauthorized
WWW-Authenticate: Basic realm = “Corporate Financials”
</code></pre>

#### 기본 인증
- 기본 인증은 가장 잘 알려진 HTTP 인증 규약이다. 거의 모든 주요 클라이언트와 서버에 기본 인증이 구현되어 있다.
- 기본 인증에서, 웹 서버는 클라이언틔 요청을 거부하고 유효한 사용자 이름과 비밀번호를 요구할 수 있다.
- 인증 과정
    - 요청 -> 인증 요구 -> 인증 -> 성공(p.325 ~ p326 인증 과정 참고)

#### 기본 인증 - Base-64 사용자 이름/비밀번호 인코딩
- HTTP 기본 인증은 사용자 이름과 비밀번호를 콜론으로 이어서 합치고, base-64 인코딩 메서드를 사용해 인코딩 한다.
- base-64 인코딩은 8비트 바이트로 이루어져 있는 시퀀스를 6비트 덩어리의 시퀀스로 변환한다.
- 각 6비트 조각은 대부분 문자와 숫자로 이루어진 특별한 64개의 문자 중에서 선택 된다.
- Base-64
    - 바이너리, 텍스트, 국제 문자 데이터 문자열 받아서 전송할 수 있게, 그 문자열을 전송 가능한 문자인 알파벳으로 변환하기 위해 발명됐다.
    - 전송 중에 문자여리 변질될 걱정 없이 원격에서 디코딩할 수 있다.
    - 국제 문자나 HTTP 헤더에서 사용할 수 없는 문자를 포함한 사용자 이름이나 비밀번호를 보내야할 때 유용할 수 있다.

#### 기본 인증 - 프락시 인증
- 중개 프락시 서버를 통해 인증할 수도 있다.
- 프락시 서버에서 접근 정책을 중앙 관리 할 수 있기 때문에, 회사 리소스 전체에 대해 통합적인 접근 제어를 하기 위해서 프락시 서버를 사용하면 좋다.
- 이 절차의 첫 번째 단계는 프락시 인증으로 사용자를 식별하는 것이다.
- 프락시 인증은 웹 서버의 인증과 헤더와 상태 코드만 다르고 절차는 같다.
- p.328 표 참고

#### 기본 인증의 보안 결함
- 기본 인증은 단순하고 편리하지만 안심할 수는 없다.
- 기본 인증은 악의적이지 않은 누군가가 의도치 않게 리소스에 접근하는 것을 막는데 사용하거나, SSL 같은 암호 기술과 혼용한다.
- 보안 결함
    - 1. 사용자의 아이디/비밀번호가 Base-64로 인코딩 되어 있으면 디코딩을 하기에도 매우 쉽다.(암호화/복호화가 아니다.)
    - 2. 사용자의 아이디/비밀번호가 인코딩 되어 있더라도 중간에서 캡쳐해서 그대로 사용할 수 있다.
    - 3. 일부 사용자들의 아이디/비밀번호를 같게 사용하기 때문에 보안에 크게 필요없는 사이트의 아이디/비밀번호를 캡쳐해서 다른곳에서 그대로 사용될 수도 있다.
    - 4. 중간에 프락시나 중개자가 개입하는 경우 인증과정이 다르게 동작할 수 있다.(다른 부분을 수정 해버릴수 있다.)
    - 5. 기본 인증은 가짜 서버의 위장에 취약하다. 사용자가 가짜 서버를 진짜 서버라고 믿고 아이디/비밀번호를 입력할 수도 있다.
- 종합해보면, 기본 인증은 일반적인 환경에서 개인화나 접근을 제어하는데 편리하며, 다른 사람들이 보지 않기를 원하기는 하지만, 보더라도 치명적이지 않은 경우에는 여전히 유용하다.
- 기본 인증은 호기심 많은 사용자가 우연이나 사고로 정보에 접근해서 보는 것을 예방하는데 사용한다.
- 기본 인증은 사용자 이름과 비밀번호를 악의적인 개인들에게 숨기려고 암호화된 데이터 전송(SSL 같은)과 함께 연계해서 사용할 수 있다. 이는 널리 사용하는 기술이다.

#### 정리
- HTTP에서 기본적으로 인증을 제공하고 있다는걸 알게 되었다.(기본 인증/다이제스트 인증)
- Base-64 인코딩은 암호화가 아니기 때문에 디코딩을 통하여 쉽게 사용자의 정보를 알게 되지 않을까라는 의문이 있었는데 SSL과 같이 암호화 전송 방식을 함께 이용하면 된다는 내용도 있었다.(내생각이 책뒷부분에 나왔다.ㅎㅎㅎ)
- 기본 인증은 다양한 보안 취약문제점이 존재한다.

