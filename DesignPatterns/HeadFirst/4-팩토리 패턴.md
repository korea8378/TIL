# Head First Design Patterns

## 07월 20일

### 4장 팩토리 패턴

#### 개요
- 느슨한 결합을 이용하는 객체지향 디자인을 만들어 보자
- 객체의 인스턴스를 만드는 작업이 항상 공개되어 있어야 하는 것은 아니며, 모든 것을 공개했다가는 결합과 관련된 문제가 생길 수 있다.
- 팩토리 패턴을 이용하여 불필요한 의존성을 없애는 방법을 알아보자.

#### new는 구상객체를 뜻한다.
- new를 사용하는 것은 구상 클래스의 인스턴스를 만드는 것이다.
- 구상객체를 의존하는 코드가 있다면 뭔가 변경하거나 확장해야 할 때 코드를 다시 확인하고 추가 또는 제거해야한 다는 것을 뜻한다.
- 따라서 코드를 이런 식으로 만들면 관리 및 갱신하기가 어려워지고, 오류가 생길 가능성도 높아지고 된다.
- 변화 취약하다.(애플리케이션은 변화한다)
- 인터페이스를 바탕으로 코드를 만들면, 다형성 덕분에 어떤 클래스든 특정 인터페이스만 구현하면 사용할 수 있기 때문에 인터페이스에 맞춰서 개발을 하자.

#### 간단한 팩토리
- 변화되는 부분(객체 생성)을 따로 분리해서 뽑아내자.
- 객체 생성을 처리하는 클래스를 팩토리라고 부른다.
- 정적 팩토리
    - 간단한 팩토리를 정적 메소드로 정의하는 기법도 일반적으로 많이 쓰인다. 정적 팩토리라고 부르기도 한다.
    - 하지만 서브 클래스를 만들어서 객체 생성 메소드의 행동을 변경 시킬 수 없다는 단점이 있다.
- 간단한 팩토리는 디자인 패턴이라고 할 수 없다. 
- 유연함이 존재하지 않는다. 팩토리가 구상클래스이기 때문에 유연하게 변경될수 가 없다.

#### 디자인 패턴 - 인터페이스를 구현한다.
- 인터페이스를 구현한다는 표현이 나온다고 해서 항상 클래스를 선언하는 부분을 implements 키워드를 써서 어떤 자바 인터페이스를 구현하는 클래스를 만든다라고 생각하면 안된다.
- 일반적으로 어떤 상위 형식(클래스, 인터페이스)에 있는 메소드를 구현하는 구상 클래스는 그 상위 형식의 인터페이스를 구현하는 클래스라고 생각하면 된다.

#### 팩토리 메소드 패턴
- 팩토리 메소드 패턴은 서브클래스에서 어떤 클래스를 만들지를 결정하게 함으로써 객체 생성을 캡슐화합니다.
- 팩토리 메소드 패턴에서는 객체를 생성하기 위한 인터페이스를 정의하는데, 어떤 클래스의 인스턴스를 만들지는 서브 클래스에서 결정하게 만듭니다.
- 팩토리 메소드 패턴을 이용하면 클래스의 인스턴스를 만드는 일을 서브클래스에게 맡긴다.
- 팩토리 메소드는 객체 생성을 처리하며, 팩토리 메소드를 이용하면 객체를 생성하는 작업을 서브클래스에 캡슐화시킬 수 있습니다.
- 이렇게 하면 수퍼클래스에 있는 클라이언트 코드와 서브클래스에 있는 객체 생성 코드를 분리시킬 수 있습니다.
- 팩토리 메소드 패턴을 사용하면 서브클래스에 따라 생산되는 객체 인스턴스가 결정된다.

#### 팩토리
- 객체 생성 코드를 전부 한 객체 또는 메소드에 집어 넣으면 코드에서 중복되는 내용을 제거할 수 있고, 나중에 관리할 때도 한군데에만 신경을 쓰면 된다.
- 클라이언트 입장에서는 객체 인스턴스를 만들 때 필요한 구상 클래스가 아닌 인터페이스만 필요로 하게 된다.
- 그 결과 유연성과 확장성이 뛰어난 코드를 만들수 있게 된다.

#### 디자인 원칙 - OCP : 추상화된 것에 의존하도록 만들어라. 구상 클래스에 의존하도록 만들지 않도록 한다.
- 디자인 원칙 : 특정 구현이 아닌 인터페이스에 맞춰서 프로그래밍 한다와 똑같다고 생각할 수 있다.
- 하지만 OCP는 추상화를 더 많이 강조한다.
- 이 원칙에는 고수준 구성요소가 저수준 구성요소에 의존하면 안 된다는 것이 내포되어 있다.
- 구상 클래스처럼 구체적인 것이 아닌 추상클래스나 인터페이스와 같이 추상적인 것에 의존하는 코드를 만들어야 합니다.
- 고수준 모듈과 저수준 모듈이 둘다 하나의 추상 클래스에 의존하게 된다.

#### OCP 원칙을 지키는데 도움이 될만한 가이드 라인
- 1.어떤 변수에도 구상 클래스에 대한 래퍼런스를 저장하지 말자.
- 2.구상 클래스에서 유도된 클래스를 만들지 말자.
- 3.베이스 클래스에 이미 구현되어 있던 메소드를 오버라이드하지 말자.
- 반드시 위의 가이드라인을 지켜야하는 규칙이 아니면 개발자 지향해야 한다는 것으로만 알고 있자.
- 상황에 맞게 디자인원칙을 적용해야하는지 말아야하는지 고민해보고 적절하게 적용을 하도록 하자.

#### 추상 팩토리 패턴
- 추상 팩토리 패턴에서는 인터페이스를 이용하여 서로 연관된, 또는 의존하는 객체를 구상 클래스를 지정하지 않고도 생성할 수 있다.
- 클라이언트에서 추상 인터페이스를 통해서 일련의 제품들을 공급 받을 수 있다. 이때, 실제로 어떤 제품이 생산되는지 전혀 알 필요도 없다.
- 클라이언트와 팩토리에서 생산되는 제품을 분리시킬 수 있다.

#### 추상 팩토리 패턴과 팩토리 메서드 패턴
- 추상 팩토리패턴
    - 객체 구성을 통해서 객체 생성
    - 클라이언트와 클라이언트에서 사용하는 실제 구상 제품이 분리 된다.
    - 클라이언트에서 서로 연관된 일련의 제품들을 만들어야 할 때, 즉 제품군을 만들어야 할 때 사용하자.
- 팩토리 메서드 패턴
    - 상속을 통해서 객체를 생성
    - 클라이언트와 구상 형식을 분리시켜주는 역할을 한다.
    - 클라이언트 코드와 인스턴스를 만들어야 할 구상 클래스를 분리시켜야 할 때 사용하자.
    - 어떤 구상 클래스를 필요로 하게 될지 미리 알 수 없는 경우에도 유용하다.
- 두가지 패턴 모두 객체 생성을 캡슐화해서 애플리케이션 결합을 느슨하게 만들고, 특정 구현에 덜 의존하도록 만들 수 있다.
