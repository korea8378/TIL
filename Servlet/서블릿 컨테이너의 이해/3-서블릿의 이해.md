# 서블릿 컨테이너의 이해

## 2월 14일

### 3.서블릿의 이해

#### SUN사의 서블릿
- 1997년 SUN 사는 웹서비스를 위한 기본 인터페이스로 서블릿을 제안했습니다.
- 또한 서블릿을 배치, 서비스하는 서버 구조로 서블릿 컨테이너의 개념을 전파하기 시작했습니다.
- 이것은 사용자가 원하는 비즈니스 로직을 서블릿 인터페이스안에서 구현하고, 서블릿 컨테이너에 해당 서블릿 구현을 배치라는 특별한 절차를 거쳐 등록하면 서블릿 컨테이너가 네트워크 통신, 생명주기 관리, 스레드 기반의 병렬처리를 대행하겠다는 약속이었습니다.

#### 서블릿이란
- 원칙적으로 javax.servlet.Servlet 인터페이스를 구현한 것이 서블릿입니다.
- 일반적인 자바 독립 실행 프로그램은 public static void main(String[] args) 메서드가 있어서, 해당 메서드가 시작되면 프로그램 수행을 시작하며 main 메서드가 끝나면 프로그램 역시 종료됩니다.
- 하지만 서블릿은 서블릿 컨테이너 내에 등록된 후 서블릿 컨테이너에 의해 생성, 호출, 소멸이 이뤄집니다. 다시 말해, 서블릿은 독립적으로 실행되지 않고, main 메서드가 필요하지 않으며, 서블릿 컨테이너에 의해서 서블릿의 상태가 바뀝니다.

#### 서블릿 컨테이너
- 서블릿 컨테이너는 서블릿의 생명주기에 따라 서블릿의 상태를 변경하면서 서블릿 인터페이스에 정의된 각 메서드를 불러줍니다.
- 이 HTTP 프로토콜로 전달된 메시지는 서블릿 컨테이너에서 해석되고 재조합돼 웹프로그래머가 작성한 서블릿으로 전달되는 과정을 거칩니다.
- 이때 해당 서블릿의 매개변수로 ServletRequest와 ServletResponse를 가지는 serviet 메서드가 호출되면 클라이언트로부터 전달받은 메시지는 ServletRequest 인터페이스를 통해 전달됩니다.

#### GenericServlet
- 서블릿 인터페이스만 구현하면 서블릿 컨테이너가 생성, 소멸 등의 생명주기 관리 작업을 수행할 수 있습니다.
- 따라서 서블릿을 작성하는 프로그래머들은 반복적으로 동일한 서블릿 인터페이스를 구현하는 대신 GenericServlet을 상속해서 사용합니다.

#### HttpServlet
- 일반적으로 서블릿이라 하면 거의 대부분 이 HttpSevlet을 상속받은 서블릿을 의미합니다.
- HttpServlet은 GenericServlet을 상속받으며, GenricServlet의 유일한 추상 메서드인 service를 HTTP프로토콜 요청 메서드에 적합하게 재구현한 것입니다.
- 서블릿 컨테이너는 받은 요청에 대해 서블릿을 선택한 Servlet 인터페이스에 정의된 service(ServletRequest, ServletResponse)를 호출합니다. 그러면 클래스 상속 위계에 따라 그처리가 부모 클래스인 GenricServlet에서 자식 클래스인 HttpServlet으로 넘어옵니다. HttpServlet의 service 메서드 내에서는 HTTP 요청 메서드에 의해 여러 doXXX 메서드로 분기돼 처리됩니다.
- HttpServlet을 상속받아 웹 프로그래머가 작성한 서블릿은 이 doXXX 메서드를 다시 오버라이딩해 HTTP 메서드별로 서로 다른 처리를 수행합니다.

#### 배치
- 개발자가 만든 Servlet 클래스를 서버 위에서 동작시키려면 톰캣 서버가 Serlvet 클래스를 찾을 방법이 있어야합니다.
- 또한 어떤 URL로 요청이 들어왔을 때 Servlet 클래스를 실행해야 한다는 사실을 알려주어야 한다는 의미입니다.
- 서블릿 컨테이너가 제공하는 이런 과정을 배치라고 합니다.
- 개발자가 개발한 웹어플리케이션을 was이 찾을 수 있게 하는 것이 배치입니다.
- 다시 말해 배치는 서블릿을 포함한 웹 애플리케이션을 서블릿 컨테이너에 알려주는 과정입니다.(디렉토리 배치, web.xml-클래스패스 설정)

#### webapps
- was은 webapps 디렉터리 아래 있는 클래스들을 웹 어플리케이션 구조로 자동으로 인식한다.
- 웹 애플맄에션으로 간주되는 클래스들을 was서버에 배치가 됩니다.

