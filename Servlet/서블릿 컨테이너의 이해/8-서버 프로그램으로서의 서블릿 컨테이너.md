# 서블릿 컨테이너의 이해

## 3월 3일

### 8.서버 프로그램으로서의 서블릿 컨테이너

#### 서블릿 컨테이너
- 서블릿 컨테이너도 main 메서드를 가진 자바 애플리케이션입니다.
- 초기화 코드의 시작 시점에서 따라가 본다면 충분히 분석할 수 있고, 또 그럴 만한 가치가 있습니다.

#### 서블릿 컨테이너가 서블릿을 호출하는 과정
- 1.서블릿 컨테이너는 서블릿이 포함된 웹 애플리케션을 동작시키기 위해 전용 클래스로더를 추가로 생성합니다.
- 2.웹 애플리케이션을 위한 클래스로더는 서블릿 명세에 미리 약속된 특정위치 WEB-INF/lib, WEB-INF/classes에 있는 jar나 class파일을 로딩합니다.
- 3.모든 서블릿은 javax.servlet.Servlet 인터페이스를 구현하므로 서블릿 컨테이너는 사용자가 작성한 다양한 형태의 서블릿을 Servlet.service 메서드로 호출할 수 있습니다.

#### 서블릿 컨테이너 구동
- 서블릿 컨이너는 “서블릿 컨테이너가 서블릿을 호출하는 과정”와 같은 전략을 컨테이너 자신을 구동시키는 데에도 사용합니다.
- 왜냐하면, 서블릿 컨테이너에 추가하고 싶은 라이브러리가 있을 때, 매번 JVM을 기동하는 스크립트 파일을 열어 클래스패스 인자를 수정하는 일은 능률적인지 않습니다. 
- 뿐만 아니라 라이브러리에 포함된 모든 jar 파일을 일일이 나열한다면 관리가 힘들어지기 때문입니다.
- 이런 이유로 톰캣은 JVM을 시작할 수 있는 최소한의 클래스만 bin 디렉터리 아래 bootstrap.jar 파일에 모으고 기동 스크립트 내에서는 jar 파일을 클래스패스로 설정합니다.
- 그리고 JVM을 구동한 다음 프로그램상에서 실재 서블릿 컨테이너 역할을 할 클래스로더를 새로 생성합니다.

#### 생명주기 관리
- 사용자가 설정 파일에 정의된 각 XML 엘리먼트는 Digester에 의해 서버객체로 변경돼 로딩되며, 이런 객체는 Lifecycle 인터페이스를 구현했으므로 프로그래밍적으로 초기화, 시작, 종료, 소멸 등을 컨트롤할 수 있다는 의미가 됩니다.
